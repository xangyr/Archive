`timescale 1ns / 1ps


module MainMemory(
    input clk,
    input [31:0] IMEM_Read_Address,
    output [511:0] IMEM_Read_Data,
    input IMEM_Read_ctrl,
    input [31:0] DMEM_Read_Address,
    output [255:0] DMEM_Read_Data,
    input DMEM_Read_ctrl,
    input [31:0] DMEM_Write_Address,
    input [255:0] DMEM_Write_Data,
    input DMEM_Write_ctrl
    );

    reg [7:0] MEMCONTENTS [65535:0];

    wire [15:0] IADDR16;
    assign IADDR16={IMEM_Read_Address[15:6],6'b000000};
    wire [15:0] DADDR16_r;
    assign DADDR16_r={DMEM_Read_Address[15:5],5'b00000};
    wire [15:0] DADDR16_w;
    assign DADDR16_w={DMEM_Write_Address[15:5],5'b00000};
   
    wire [255:0] D_zv;
    assign D_zv = 256'h0;
    wire [511:0] I_zv;
    assign I_zv = 512'h0;

    assign IMEM_Read_Data = (IMEM_Read_ctrl)?
    {MEMCONTENTS[IADDR16],
    MEMCONTENTS[IADDR16|6'b000001],
    MEMCONTENTS[IADDR16|6'b000010],
    MEMCONTENTS[IADDR16|6'b000011],
    MEMCONTENTS[IADDR16|6'b000100],
    MEMCONTENTS[IADDR16|6'b000101],
    MEMCONTENTS[IADDR16|6'b000110],
    MEMCONTENTS[IADDR16|6'b000111],
    MEMCONTENTS[IADDR16|6'b001000],
    MEMCONTENTS[IADDR16|6'b001001],
    MEMCONTENTS[IADDR16|6'b001010],
    MEMCONTENTS[IADDR16|6'b001011],
    MEMCONTENTS[IADDR16|6'b001100],
    MEMCONTENTS[IADDR16|6'b001101],
    MEMCONTENTS[IADDR16|6'b001110],
    MEMCONTENTS[IADDR16|6'b001111],
    MEMCONTENTS[IADDR16|6'b010000],
    MEMCONTENTS[IADDR16|6'b010001],
    MEMCONTENTS[IADDR16|6'b010010],
    MEMCONTENTS[IADDR16|6'b010011],
    MEMCONTENTS[IADDR16|6'b010100],
    MEMCONTENTS[IADDR16|6'b010101],
    MEMCONTENTS[IADDR16|6'b010110],
    MEMCONTENTS[IADDR16|6'b010111],
    MEMCONTENTS[IADDR16|6'b011000],
    MEMCONTENTS[IADDR16|6'b011001],
    MEMCONTENTS[IADDR16|6'b011010],
    MEMCONTENTS[IADDR16|6'b011011],
    MEMCONTENTS[IADDR16|6'b011100],
    MEMCONTENTS[IADDR16|6'b011101],
    MEMCONTENTS[IADDR16|6'b011110],
    MEMCONTENTS[IADDR16|6'b011111],
    MEMCONTENTS[IADDR16|6'b100000],
    MEMCONTENTS[IADDR16|6'b100001],
    MEMCONTENTS[IADDR16|6'b100010],
    MEMCONTENTS[IADDR16|6'b100011],
    MEMCONTENTS[IADDR16|6'b100100],
    MEMCONTENTS[IADDR16|6'b100101],
    MEMCONTENTS[IADDR16|6'b100110],
    MEMCONTENTS[IADDR16|6'b100111],
    MEMCONTENTS[IADDR16|6'b101000],
    MEMCONTENTS[IADDR16|6'b101001],
    MEMCONTENTS[IADDR16|6'b101010],
    MEMCONTENTS[IADDR16|6'b101011],
    MEMCONTENTS[IADDR16|6'b101100],
    MEMCONTENTS[IADDR16|6'b101101],
    MEMCONTENTS[IADDR16|6'b101110],
    MEMCONTENTS[IADDR16|6'b101111],
    MEMCONTENTS[IADDR16|6'b110000],
    MEMCONTENTS[IADDR16|6'b110001],
    MEMCONTENTS[IADDR16|6'b110010],
    MEMCONTENTS[IADDR16|6'b110011],
    MEMCONTENTS[IADDR16|6'b110100],
    MEMCONTENTS[IADDR16|6'b110101],
    MEMCONTENTS[IADDR16|6'b110110],
    MEMCONTENTS[IADDR16|6'b110111],
    MEMCONTENTS[IADDR16|6'b111000],
    MEMCONTENTS[IADDR16|6'b111001],
    MEMCONTENTS[IADDR16|6'b111010],
    MEMCONTENTS[IADDR16|6'b111011],
    MEMCONTENTS[IADDR16|6'b111100],
    MEMCONTENTS[IADDR16|6'b111101],
    MEMCONTENTS[IADDR16|6'b111110],
    MEMCONTENTS[IADDR16|6'b111111]}
    :I_zv;
    assign DMEM_Read_Data = (DMEM_Read_ctrl)?
    {MEMCONTENTS[DADDR16_r|5'b00000],
    MEMCONTENTS[DADDR16_r|5'b00001],
    MEMCONTENTS[DADDR16_r|5'b00010],
    MEMCONTENTS[DADDR16_r|5'b00011],
    MEMCONTENTS[DADDR16_r|5'b00100],
    MEMCONTENTS[DADDR16_r|5'b00101],
    MEMCONTENTS[DADDR16_r|5'b00110],
    MEMCONTENTS[DADDR16_r|5'b00111],
    MEMCONTENTS[DADDR16_r|5'b01000],
    MEMCONTENTS[DADDR16_r|5'b01001],
    MEMCONTENTS[DADDR16_r|5'b01010],
    MEMCONTENTS[DADDR16_r|5'b01011],
    MEMCONTENTS[DADDR16_r|5'b01100],
    MEMCONTENTS[DADDR16_r|5'b01101],
    MEMCONTENTS[DADDR16_r|5'b01110],
    MEMCONTENTS[DADDR16_r|5'b01111],
    MEMCONTENTS[DADDR16_r|5'b10000],
    MEMCONTENTS[DADDR16_r|5'b10001],
    MEMCONTENTS[DADDR16_r|5'b10010],
    MEMCONTENTS[DADDR16_r|5'b10011],
    MEMCONTENTS[DADDR16_r|5'b10100],
    MEMCONTENTS[DADDR16_r|5'b10101],
    MEMCONTENTS[DADDR16_r|5'b10110],
    MEMCONTENTS[DADDR16_r|5'b10111],
    MEMCONTENTS[DADDR16_r|5'b11000],
    MEMCONTENTS[DADDR16_r|5'b11001],
    MEMCONTENTS[DADDR16_r|5'b11010],
    MEMCONTENTS[DADDR16_r|5'b11011],
    MEMCONTENTS[DADDR16_r|5'b11100],
    MEMCONTENTS[DADDR16_r|5'b11101],
    MEMCONTENTS[DADDR16_r|5'b11110],
    MEMCONTENTS[DADDR16_r|5'b11111]}
    :D_zv;
    
    always@(posedge clk)
    begin
    if (DMEM_Write_ctrl)
        begin
        MEMCONTENTS[DADDR16_w|5'b00000] <= DMEM_Write_Data[255:248];
        MEMCONTENTS[DADDR16_w|5'b00001] <= DMEM_Write_Data[247:240];
        MEMCONTENTS[DADDR16_w|5'b00010] <= DMEM_Write_Data[239:232];
        MEMCONTENTS[DADDR16_w|5'b00011] <= DMEM_Write_Data[231:224];
        MEMCONTENTS[DADDR16_w|5'b00100] <= DMEM_Write_Data[223:216];
        MEMCONTENTS[DADDR16_w|5'b00101] <= DMEM_Write_Data[215:208];
        MEMCONTENTS[DADDR16_w|5'b00110] <= DMEM_Write_Data[207:200];
        MEMCONTENTS[DADDR16_w|5'b00111] <= DMEM_Write_Data[199:192];
        MEMCONTENTS[DADDR16_w|5'b01000] <= DMEM_Write_Data[191:184];
        MEMCONTENTS[DADDR16_w|5'b01001] <= DMEM_Write_Data[183:176];
        MEMCONTENTS[DADDR16_w|5'b01010] <= DMEM_Write_Data[175:168];
        MEMCONTENTS[DADDR16_w|5'b01011] <= DMEM_Write_Data[167:160];
        MEMCONTENTS[DADDR16_w|5'b01100] <= DMEM_Write_Data[159:152];
        MEMCONTENTS[DADDR16_w|5'b01101] <= DMEM_Write_Data[151:144];
        MEMCONTENTS[DADDR16_w|5'b01110] <= DMEM_Write_Data[143:136];
        MEMCONTENTS[DADDR16_w|5'b01111] <= DMEM_Write_Data[135:128];
        MEMCONTENTS[DADDR16_w|5'b10000] <= DMEM_Write_Data[127:120];
        MEMCONTENTS[DADDR16_w|5'b10001] <= DMEM_Write_Data[119:112];
        MEMCONTENTS[DADDR16_w|5'b10010] <= DMEM_Write_Data[111:104];
        MEMCONTENTS[DADDR16_w|5'b10011] <= DMEM_Write_Data[103:96];
        MEMCONTENTS[DADDR16_w|5'b10100] <= DMEM_Write_Data[95:88];
        MEMCONTENTS[DADDR16_w|5'b10101] <= DMEM_Write_Data[87:80];
        MEMCONTENTS[DADDR16_w|5'b10110] <= DMEM_Write_Data[79:72];
        MEMCONTENTS[DADDR16_w|5'b10111] <= DMEM_Write_Data[71:64];
        MEMCONTENTS[DADDR16_w|5'b11000] <= DMEM_Write_Data[63:56];
        MEMCONTENTS[DADDR16_w|5'b11001] <= DMEM_Write_Data[55:48];
        MEMCONTENTS[DADDR16_w|5'b11010] <= DMEM_Write_Data[47:40];
        MEMCONTENTS[DADDR16_w|5'b11011] <= DMEM_Write_Data[39:32];
        MEMCONTENTS[DADDR16_w|5'b11100] <= DMEM_Write_Data[31:24];
        MEMCONTENTS[DADDR16_w|5'b11101] <= DMEM_Write_Data[23:16];
        MEMCONTENTS[DADDR16_w|5'b11110] <= DMEM_Write_Data[15:8];
        MEMCONTENTS[DADDR16_w|5'b11111] <= DMEM_Write_Data[7:0];
        end
    end

initial
begin
    $readmemh("mem.mem",MEMCONTENTS);
end  
endmodule
